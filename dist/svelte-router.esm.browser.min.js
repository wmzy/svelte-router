/*!
  * svelte-router v0.1.0
  * (c) 2019 Evan You
  * @license MIT
  */
import{getContext as t,setContext as e,tick as n,onMount as r,onDestroy as o}from"svelte";import{SvelteComponent as s,create_slot as i,get_slot_changes as a,get_slot_context as c,init as u,safe_not_equal as h,assign as p,check_outros as l,detach as f,empty as d,get_spread_update as m,group_outros as y,insert as g,mount_component as w,on_outro as $,subscribe as b,element as x,listen as v}from"svelte/internal";import{writable as k,derived as E}from"svelte/store";const R=Object.create(null);function O(){return t(R)}function T(t){return e(R,t)}const j=Object.create(null);function C(){return t(j)}function A(t){return e(j,t)}const S=Object.create(null);function P(){return t(S)}function L(t){return e(S,t)}function q(t){var e;const n=t.$$slots.default,r=i(n,t,null);return{c(){r&&r.c()},l(t){r&&r.l(t)},m(t,n){r&&r.m(t,n),e=!0},p(t,e){r&&r.p&&t.$$scope&&r.p(a(n,e,t),c(n,e,null))},i(t){e||(r&&r.i&&r.i(t),e=!0)},o(t){r&&r.o&&r.o(t),e=!1},d(t){r&&r.d(t)}}}function U(t,s,i){let{router:a}=s;r(()=>{if(!a.nextTick)return a.nextTick=(t=>n().then(t)),i("router",a),()=>delete a.nextTick});const c=a.currentRoute,u=k(a),h=k(c),p=k(c.matched);let l;e(R,u),e(j,h),e(S,p),o(()=>l());let{$$slots:f={},$$scope:d}=s;return t.$set=(t=>{"router"in t&&i("router",a=t.router),"$$scope"in t&&i("$$scope",d=t.$$scope)}),t.$$.update=((t={removeListener:1,router:1})=>{if(t.removeListener||t.router){l&&l(),u.set(a);const t=a.currentRoute;h.set(t),p.set(t.matched),i("removeListener",l=a.listen(t=>{h.set(t),p.set(t.matched)}))}}),{router:a,$$slots:f,$$scope:d}}class M extends s{constructor(t){super(),u(this,t,U,q,h,["router"])}}function I(t){return Object.prototype.toString.call(t).indexOf("Error")>-1}function H(t,e){for(const n in e)t[n]=e[n];return t}function _(t){var e,n,r=[t.propsToPass],o=t.component;function s(t){let e={};for(var n=0;n<r.length;n+=1)e=p(e,r[n]);return{props:e}}if(o)var i=new o(s());return{c(){i&&i.$$.fragment.c(),e=d()},m(t,r){i&&w(i,t,r),g(t,e,r),n=!0},p(t,n){var a=t.propsToPass?m(r,[n.propsToPass]):{};if(o!==(o=n.component)){if(i){y();const t=i;$(()=>{t.$destroy()}),t.$$.fragment.o(1),l()}o?((i=new o(s())).$$.fragment.c(),i.$$.fragment.i(1),w(i,e.parentNode,e)):i=null}else o&&i.$set(a)},i(t){n||(i&&i.$$.fragment.i(t),n=!0)},o(t){i&&i.$$.fragment.o(t),n=!1},d(t){t&&f(e),i&&i.$destroy(t)}}}function z(n,r,o){let s,i,{name:a="default"}=r,c=t(j);b(n,c,t=>{o("$routeStore",i=t)});let u=t(S);e(S,E(u,([t,...e])=>e));const h=E(u,([t])=>t);let p,l;return b(n,h,t=>{o("$matched",s=t)}),n.$set=(t=>{"name"in t&&o("name",a=t.name)}),n.$$.update=((t={$matched:1,name:1,$routeStore:1,propsToPass:1,component:1})=>{if((t.$matched||t.name||t.$routeStore||t.propsToPass||t.component)&&s&&(o("component",l=s.components[a]),o("propsToPass",p=function(t,e){switch(typeof e){case"undefined":return;case"object":return e;case"function":return e(t);case"boolean":return e?t.params:void 0}}(i,s.props&&s.props[a])),p)){o("propsToPass",p=data.props=H({},p));const t=data.attrs=data.attrs||{};for(const e in p)l.props&&e in l.props||(t[e]=p[e],delete p[e])}}),{name:a,routeStore:c,matched:h,propsToPass:p,component:l}}class B extends s{constructor(t){super(),u(this,t,z,_,h,["name"])}}function F(t){var e,n,r;const o=t.$$slots.default,s=i(o,t,null);return{c(){e=x("a"),s&&s.c(),r=v(e,"click",t.handleClick)},l(t){s&&s.l(a_nodes)},m(t,r){g(t,e,r),s&&s.m(e,null),n=!0},p(t,e){s&&s.p&&t.$$scope&&s.p(a(o,e,t),c(o,e,null))},i(t){n||(s&&s.i&&s.i(t),n=!0)},o(t){s&&s.o&&s.o(t),n=!1},d(t){t&&f(e),s&&s.d(t),r()}}}function N(e,n,r){let o,{to:s}=n;const i=t(R);b(e,i,t=>{r("$router",o=t)});let{$$slots:a={},$$scope:c}=n;return e.$set=(t=>{"to"in t&&r("to",s=t.to),"$$scope"in t&&r("$$scope",c=t.$$scope)}),{to:s,router:i,handleClick:function(t){const{location:e}=o.resolve(s);o.push(e)},$$slots:a,$$scope:c}}class J extends s{constructor(t){super(),u(this,t,N,F,h,["to"])}}const Q=/[!'()*]/g,X=t=>"%"+t.charCodeAt(0).toString(16),Y=/%2C/g,D=t=>encodeURIComponent(t).replace(Q,X).replace(Y,","),V=decodeURIComponent;function W(t){const e={};return(t=t.trim().replace(/^(\?|#|&)/,""))?(t.split("&").forEach(t=>{const n=t.replace(/\+/g," ").split("="),r=V(n.shift()),o=n.length>0?V(n.join("=")):null;void 0===e[r]?e[r]=o:Array.isArray(e[r])?e[r].push(o):e[r]=[e[r],o]}),e):e}function G(t){const e=t?Object.keys(t).map(e=>{const n=t[e];if(void 0===n)return"";if(null===n)return D(e);if(Array.isArray(n)){const t=[];return n.forEach(n=>{void 0!==n&&(null===n?t.push(D(e)):t.push(D(e)+"="+D(n)))}),t.join("&")}return D(e)+"="+D(n)}).filter(t=>t.length>0).join("&"):null;return e?`?${e}`:""}const K=/\/?$/;function Z(t,e,n,r){const o=r&&r.options.stringifyQuery;let s=e.query||{};try{s=tt(s)}catch(t){}const i={name:e.name||t&&t.name,meta:t&&t.meta||{},path:e.path||"/",hash:e.hash||"",query:s,params:e.params||{},fullPath:rt(e,o),matched:t?nt(t):[]};return n&&(i.redirectedFrom=rt(n,o)),Object.freeze(i)}function tt(t){if(Array.isArray(t))return t.map(tt);if(t&&"object"==typeof t){const e={};for(const n in t)e[n]=tt(t[n]);return e}return t}const et=Z(null,{path:"/"});function nt(t){const e=[];for(;t;)e.unshift(t),t=t.parent;return e}function rt({path:t,query:e={},hash:n=""},r){return(t||"/")+(r||G)(e)+n}function ot(t={},e={}){if(!t||!e)return t===e;const n=Object.keys(t),r=Object.keys(e);return n.length===r.length&&n.every(n=>{const r=t[n],o=e[n];return"object"==typeof r&&"object"==typeof o?ot(r,o):String(r)===String(o)})}function st(t,e,n){const r=t.charAt(0);if("/"===r)return t;if("?"===r||"#"===r)return e+t;const o=e.split("/");n&&o[o.length-1]||o.pop();const s=t.replace(/^\//,"").split("/");for(let t=0;t<s.length;t++){const e=s[t];".."===e?o.pop():"."!==e&&o.push(e)}return""!==o[0]&&o.unshift(""),o.join("/")}function it(t){return t.replace(/\/\//g,"/")}var at=Array.isArray||function(t){return"[object Array]"==Object.prototype.toString.call(t)},ct=vt,ut=dt,ht=function(t,e){return yt(dt(t,e))},pt=yt,lt=xt,ft=new RegExp(["(\\\\.)","([\\/.])?(?:(?:\\:(\\w+)(?:\\(((?:\\\\.|[^\\\\()])+)\\))?|\\(((?:\\\\.|[^\\\\()])+)\\))([+*?])?|(\\*))"].join("|"),"g");function dt(t,e){for(var n,r=[],o=0,s=0,i="",a=e&&e.delimiter||"/";null!=(n=ft.exec(t));){var c=n[0],u=n[1],h=n.index;if(i+=t.slice(s,h),s=h+c.length,u)i+=u[1];else{var p=t[s],l=n[2],f=n[3],d=n[4],m=n[5],y=n[6],g=n[7];i&&(r.push(i),i="");var w=null!=l&&null!=p&&p!==l,$="+"===y||"*"===y,b="?"===y||"*"===y,x=n[2]||a,v=d||m;r.push({name:f||o++,prefix:l||"",delimiter:x,optional:b,repeat:$,partial:w,asterisk:!!g,pattern:v?wt(v):g?".*":"[^"+gt(x)+"]+?"})}}return s<t.length&&(i+=t.substr(s)),i&&r.push(i),r}function mt(t){return encodeURI(t).replace(/[\/?#]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}function yt(t){for(var e=new Array(t.length),n=0;n<t.length;n++)"object"==typeof t[n]&&(e[n]=new RegExp("^(?:"+t[n].pattern+")$"));return function(n,r){for(var o="",s=n||{},i=(r||{}).pretty?mt:encodeURIComponent,a=0;a<t.length;a++){var c=t[a];if("string"!=typeof c){var u,h=s[c.name];if(null==h){if(c.optional){c.partial&&(o+=c.prefix);continue}throw new TypeError('Expected "'+c.name+'" to be defined')}if(at(h)){if(!c.repeat)throw new TypeError('Expected "'+c.name+'" to not repeat, but received `'+JSON.stringify(h)+"`");if(0===h.length){if(c.optional)continue;throw new TypeError('Expected "'+c.name+'" to not be empty')}for(var p=0;p<h.length;p++){if(u=i(h[p]),!e[a].test(u))throw new TypeError('Expected all "'+c.name+'" to match "'+c.pattern+'", but received `'+JSON.stringify(u)+"`");o+=(0===p?c.prefix:c.delimiter)+u}}else{if(u=c.asterisk?encodeURI(h).replace(/[?#]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()}):i(h),!e[a].test(u))throw new TypeError('Expected "'+c.name+'" to match "'+c.pattern+'", but received "'+u+'"');o+=c.prefix+u}}else o+=c}return o}}function gt(t){return t.replace(/([.+*?=^!:${}()[\]|\/\\])/g,"\\$1")}function wt(t){return t.replace(/([=!:$\/()])/g,"\\$1")}function $t(t,e){return t.keys=e,t}function bt(t){return t.sensitive?"":"i"}function xt(t,e,n){at(e)||(n=e||n,e=[]);for(var r=(n=n||{}).strict,o=!1!==n.end,s="",i=0;i<t.length;i++){var a=t[i];if("string"==typeof a)s+=gt(a);else{var c=gt(a.prefix),u="(?:"+a.pattern+")";e.push(a),a.repeat&&(u+="(?:"+c+u+")*"),s+=u=a.optional?a.partial?c+"("+u+")?":"(?:"+c+"("+u+"))?":c+"("+u+")"}}var h=gt(n.delimiter||"/"),p=s.slice(-h.length)===h;return r||(s=(p?s.slice(0,-h.length):s)+"(?:"+h+"(?=$))?"),s+=o?"$":r&&p?"":"(?="+h+"|$)",$t(new RegExp("^"+s,bt(n)),e)}function vt(t,e,n){return at(e)||(n=e||n,e=[]),n=n||{},t instanceof RegExp?function(t,e){var n=t.source.match(/\((?!\?)/g);if(n)for(var r=0;r<n.length;r++)e.push({name:r,prefix:null,delimiter:null,optional:!1,repeat:!1,partial:!1,asterisk:!1,pattern:null});return $t(t,e)}(t,e):at(t)?function(t,e,n){for(var r=[],o=0;o<t.length;o++)r.push(vt(t[o],e,n).source);return $t(new RegExp("(?:"+r.join("|")+")",bt(n)),e)}(t,e,n):function(t,e,n){return xt(dt(t,n),e,n)}(t,e,n)}ct.parse=ut,ct.compile=ht,ct.tokensToFunction=pt,ct.tokensToRegExp=lt;const kt=Object.create(null);function Et(t,e,n){e=e||{};try{const n=kt[t]||(kt[t]=ct.compile(t));return e.pathMatch&&(e[0]=e.pathMatch),n(e,{pretty:!0})}catch(t){return""}finally{delete e[0]}}function Rt(t,e,n,r){const o=e||[],s=n||Object.create(null),i=r||Object.create(null);t.forEach(t=>{!function t(e,n,r,o,s,i){const{path:a,name:c}=o;const u=o.pathToRegexpOptions||{};const h=function(t,e,n){n||(t=t.replace(/\/$/,""));return"/"===t[0]?t:null==e?t:it(`${e.path}/${t}`)}(a,s,u.strict);"boolean"==typeof o.caseSensitive&&(u.sensitive=o.caseSensitive);const p={path:h,regex:Ot(h,u),components:o.components||{default:o.component},instances:{},name:c,parent:s,matchAs:i,redirect:o.redirect,beforeEnter:o.beforeEnter,meta:o.meta||{},props:null==o.props?{}:o.components?o.props:{default:o.props}};o.children&&o.children.forEach(o=>{const s=i?it(`${i}/${o.path}`):void 0;t(e,n,r,o,p,s)});if(void 0!==o.alias){const i=Array.isArray(o.alias)?o.alias:[o.alias];i.forEach(i=>{const a={path:i,children:o.children};t(e,n,r,a,s,p.path||"/")})}n[p.path]||(e.push(p.path),n[p.path]=p);c&&(r[c]||(r[c]=p))}(o,s,i,t)});for(let t=0,e=o.length;t<e;t++)"*"===o[t]&&(o.push(o.splice(t,1)[0]),e--,t--);return{pathList:o,pathMap:s,nameMap:i}}function Ot(t,e){return ct(t,[],e)}function Tt(t,e,n,r){let o="string"==typeof t?{path:t}:t;if(o._normalized)return o;if(o.name)return H({},t);if(!o.path&&o.params&&e){(o=H({},o))._normalized=!0;const t=H(H({},e.params),o.params);if(e.name)o.name=e.name,o.params=t;else if(e.matched.length){const n=e.matched[e.matched.length-1].path;o.path=Et(n,t,e.path)}return o}const s=function(t){let e="",n="";const r=t.indexOf("#");r>=0&&(e=t.slice(r),t=t.slice(0,r));const o=t.indexOf("?");return o>=0&&(n=t.slice(o+1),t=t.slice(0,o)),{path:t,query:n,hash:e}}(o.path||""),i=e&&e.path||"/",a=s.path?st(s.path,i,n||o.append):i,c=function(t,e={},n){const r=n||W;let o;try{o=r(t||"")}catch(t){o={}}for(const t in e)o[t]=e[t];return o}(s.query,o.query,r&&r.options.parseQuery);let u=o.hash||s.hash;return u&&"#"!==u.charAt(0)&&(u=`#${u}`),{_normalized:!0,path:a,query:c,hash:u}}function jt(t,e){const{pathList:n,pathMap:r,nameMap:o}=Rt(t);function s(t,s,i){const c=Tt(t,s,!1,e),{name:u}=c;if(u){const t=o[u];if(!t)return a(null,c);const e=t.regex.keys.filter(t=>!t.optional).map(t=>t.name);if("object"!=typeof c.params&&(c.params={}),s&&"object"==typeof s.params)for(const t in s.params)!(t in c.params)&&e.indexOf(t)>-1&&(c.params[t]=s.params[t]);if(t)return c.path=Et(t.path,c.params),a(t,c,i)}else if(c.path){c.params={};for(let t=0;t<n.length;t++){const e=n[t],o=r[e];if(Ct(o.regex,c.path,c.params))return a(o,c,i)}}return a(null,c)}function i(t,n){const r=t.redirect;let i="function"==typeof r?r(Z(t,n,null,e)):r;if("string"==typeof i&&(i={path:i}),!i||"object"!=typeof i)return a(null,n);const c=i,{name:u,path:h}=c;let{query:p,hash:l,params:f}=n;if(p=c.hasOwnProperty("query")?c.query:p,l=c.hasOwnProperty("hash")?c.hash:l,f=c.hasOwnProperty("params")?c.params:f,u){o[u];return s({_normalized:!0,name:u,query:p,hash:l,params:f},void 0,n)}if(h){const e=function(t,e){return st(t,e.parent?e.parent.path:"/",!0)}(h,t);return s({_normalized:!0,path:Et(e,f),query:p,hash:l},void 0,n)}return a(null,n)}function a(t,n,r){return t&&t.redirect?i(t,r||n):t&&t.matchAs?function(t,e,n){const r=s({_normalized:!0,path:Et(n,e.params)});if(r){const t=r.matched,n=t[t.length-1];return e.params=r.params,a(n,e)}return a(null,e)}(0,n,t.matchAs):Z(t,n,r,e)}return{match:s,addRoutes:function(t){Rt(t,n,r,o)}}}function Ct(t,e,n){const r=e.match(t);if(!r)return!1;if(!n)return!0;for(let e=1,o=r.length;e<o;++e){const o=t.keys[e-1],s="string"==typeof r[e]?decodeURIComponent(r[e]):r[e];o&&(n[o.name||"pathMatch"]=s)}return!0}const At="undefined"!=typeof window;function St(t,e,n){const r=o=>{o>=t.length?n():t[o]?e(t[o],()=>{r(o+1)}):r(o+1)};r(0)}function Pt(t){return(e,n,r)=>{let o=!1,s=0,i=null;!function(t,e){return n=t.map(t=>Object.keys(t.components).map(n=>e(t.components[n],t.instances[n],t,n))),Array.prototype.concat.apply([],n);var n}(t,(t,e,n,a)=>{if(!("function"!=typeof t||t.prototype&&t.prototype.$set)){o=!0,s++;const e=qt(e=>{(function(t){return t.__esModule||Lt&&"Module"===t[Symbol.toStringTag]})(e)&&(e=e.default),t.resolved=e,n.components[a]=e,--s<=0&&r()}),c=qt(t=>{const e=`Failed to resolve async component ${a}: ${t}`;i||(i=I(t)?t:new Error(e),r(i))});let u;try{u=t(e,c)}catch(t){c(t)}if(u)if("function"==typeof u.then)u.then(e,c);else{const t=u.component;t&&"function"==typeof t.then&&t.then(e,c)}}}),o||r()}}const Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag;function qt(t){let e=!1;return function(...n){if(!e)return e=!0,t.apply(this,n)}}class Ut{constructor(t,e){this.router=t,this.base=function(t){if(!t)if(At){const e=document.querySelector("base");t=(t=e&&e.getAttribute("href")||"/").replace(/^https?:\/\/[^\/]+/,"")}else t="/";"/"!==t.charAt(0)&&(t="/"+t);return t.replace(/\/$/,"")}(e),this.current=et,this.pending=null,this.ready=!1,this.readyCbs=[],this.readyErrorCbs=[],this.errorCbs=[]}listen(t){this.cb=t}onReady(t,e){this.ready?t():(this.readyCbs.push(t),e&&this.readyErrorCbs.push(e))}onError(t){this.errorCbs.push(t)}transitionTo(t,e,n){const r=this.router.match(t,this.current);this.confirmTransition(r,()=>{this.updateRoute(r),e&&e(r),this.ensureURL(),this.ready||(this.ready=!0,this.readyCbs.forEach(t=>{t(r)}))},t=>{n&&n(t),t&&!this.ready&&(this.ready=!0,this.readyErrorCbs.forEach(e=>{e(t)}))})}confirmTransition(t,e,n){const r=this.current,o=t=>{I(t)&&(this.errorCbs.length?this.errorCbs.forEach(e=>{e(t)}):console.error(t)),n&&n(t)};if(s=t,((i=r)===et?s===i:i&&(s.path&&i.path?s.path.replace(K,"")===i.path.replace(K,"")&&s.hash===i.hash&&ot(s.query,i.query):s.name&&i.name&&s.name===i.name&&s.hash===i.hash&&ot(s.query,i.query)&&ot(s.params,i.params)))&&t.matched.length===r.matched.length)return this.ensureURL(),o();var s,i;const{activated:a}=function(t,e){let n;const r=Math.max(t.length,e.length);for(n=0;n<r&&t[n]===e[n];n++);return{updated:e.slice(0,n),activated:e.slice(n),deactivated:t.slice(n)}}(this.current.matched,t.matched),c=[].concat(this.router.beforeHooks,a.map(t=>t.beforeEnter),Pt(a));this.pending=t;const u=(e,n)=>{if(this.pending!==t)return o();try{e(t,r,t=>{!1===t||I(t)?(this.ensureURL(!0),o(t)):"string"==typeof t||"object"==typeof t&&("string"==typeof t.path||"string"==typeof t.name)?(o(),"object"==typeof t&&t.replace?this.replace(t):this.push(t)):n(t)})}catch(t){o(t)}};St(c,u,()=>{St([].concat(this.router.resolveHooks),u,()=>{if(this.pending!==t)return o();this.pending=null,e(t)})})}updateRoute(t){const e=this.current;this.current=t,this.cb&&this.cb(t),this.router.afterHooks.forEach(n=>{n&&n(t,e)})}}const Mt=At&&function(){const t=window.navigator.userAgent;return(-1===t.indexOf("Android 2.")&&-1===t.indexOf("Android 4.0")||-1===t.indexOf("Mobile Safari")||-1!==t.indexOf("Chrome")||-1!==t.indexOf("Windows Phone"))&&(window.history&&"pushState"in window.history)}(),It=At&&window.performance&&window.performance.now?window.performance:Date;let Ht=_t();function _t(){return It.now().toFixed(3)}function zt(){return Ht}function Bt(t,e){Xt();const n=window.history;try{e?n.replaceState({key:Ht},"",t):(Ht=_t(),n.pushState({key:Ht},"",t))}catch(n){window.location[e?"replace":"assign"](t)}}function Ft(t){Bt(t,!0)}const Nt=Object.create(null);function Jt(){window.history.replaceState({key:zt()},"",window.location.href.replace(window.location.origin,"")),window.addEventListener("popstate",t=>{Xt(),t.state&&t.state.key&&function(t){Ht=t}(t.state.key)})}function Qt(t,e,n,r){if(!t.nextTick)return;const o=t.options.scrollBehavior;o&&t.nextTick(()=>{const s=function(){const t=zt();if(t)return Nt[t]}(),i=o.call(t,e,n,r?s:null);i&&("function"==typeof i.then?i.then(t=>{Wt(t,s)}).catch(t=>{}):Wt(i,s))})}function Xt(){const t=zt();t&&(Nt[t]={x:window.pageXOffset,y:window.pageYOffset})}function Yt(t){return Vt(t.x)||Vt(t.y)}function Dt(t){return{x:Vt(t.x)?t.x:window.pageXOffset,y:Vt(t.y)?t.y:window.pageYOffset}}function Vt(t){return"number"==typeof t}function Wt(t,e){const n="object"==typeof t;if(n&&"string"==typeof t.selector){const n=document.querySelector(t.selector);if(n){let o=t.offset&&"object"==typeof t.offset?t.offset:{};e=function(t,e){const n=document.documentElement.getBoundingClientRect(),r=t.getBoundingClientRect();return{x:r.left-n.left-e.x,y:r.top-n.top-e.y}}(n,o={x:Vt((r=o).x)?r.x:0,y:Vt(r.y)?r.y:0})}else Yt(t)&&(e=Dt(t))}else n&&Yt(t)&&(e=Dt(t));var r;e&&window.scrollTo(e.x,e.y)}class Gt extends Ut{constructor(t,e){super(t,e);const n=t.options.scrollBehavior,r=Mt&&n;r&&Jt();const o=Kt(this.base);window.addEventListener("popstate",e=>{const n=this.current,s=Kt(this.base);this.current===et&&s===o||this.transitionTo(s,e=>{r&&Qt(t,e,n,!0)})})}go(t){window.history.go(t)}push(t,e,n){const{current:r}=this;this.transitionTo(t,t=>{Bt(it(this.base+t.fullPath)),Qt(this.router,t,r,!1),e&&e(t)},n)}replace(t,e,n){const{current:r}=this;this.transitionTo(t,t=>{Ft(it(this.base+t.fullPath)),Qt(this.router,t,r,!1),e&&e(t)},n)}ensureURL(t){if(Kt(this.base)!==this.current.fullPath){const e=it(this.base+this.current.fullPath);t?Bt(e):Ft(e)}}getCurrentLocation(){return Kt(this.base)}}function Kt(t){let e=decodeURI(window.location.pathname);return t&&0===e.indexOf(t)&&(e=e.slice(t.length)),(e||"/")+window.location.search+window.location.hash}class Zt extends Ut{constructor(t,e,n){super(t,e),n&&function(t){const e=Kt(t);if(!/^\/#/.test(e))return window.location.replace(it(t+"/#"+e)),!0}(this.base)||te()}setupListeners(){const t=this.router.options.scrollBehavior,e=Mt&&t;e&&Jt(),window.addEventListener(Mt?"popstate":"hashchange",()=>{const t=this.current;te()&&this.transitionTo(ee(),n=>{e&&Qt(this.router,n,t,!0),Mt||oe(n.fullPath)})})}push(t,e,n){const{current:r}=this;this.transitionTo(t,t=>{re(t.fullPath),Qt(this.router,t,r,!1),e&&e(t)},n)}replace(t,e,n){const{current:r}=this;this.transitionTo(t,t=>{oe(t.fullPath),Qt(this.router,t,r,!1),e&&e(t)},n)}go(t){window.history.go(t)}ensureURL(t){const e=this.current.fullPath;ee()!==e&&(t?re(e):oe(e))}getCurrentLocation(){return ee()}}function te(){const t=ee();return"/"===t.charAt(0)||(oe("/"+t),!1)}function ee(){let t=window.location.href;const e=t.indexOf("#");if(e<0)return"";const n=(t=t.slice(e+1)).indexOf("?");if(n<0){const e=t.indexOf("#");t=e>-1?decodeURI(t.slice(0,e))+t.slice(e):decodeURI(t)}else n>-1&&(t=decodeURI(t.slice(0,n))+t.slice(n));return t}function ne(t){const e=window.location.href,n=e.indexOf("#");return`${n>=0?e.slice(0,n):e}#${t}`}function re(t){Mt?Bt(ne(t)):window.location.hash=t}function oe(t){Mt?Ft(ne(t)):window.location.replace(ne(t))}class se extends Ut{constructor(t,e){super(t,e),this.stack=[],this.index=-1}push(t,e,n){this.transitionTo(t,t=>{this.stack=this.stack.slice(0,this.index+1).concat(t),this.index++,e&&e(t)},n)}replace(t,e,n){this.transitionTo(t,t=>{this.stack=this.stack.slice(0,this.index).concat(t),e&&e(t)},n)}go(t){const e=this.index+t;if(e<0||e>=this.stack.length)return;const n=this.stack[e];this.confirmTransition(n,()=>{this.index=e,this.updateRoute(n)})}getCurrentLocation(){const t=this.stack[this.stack.length-1];return t?t.fullPath:"/"}ensureURL(){}}class ie{constructor(t={}){this.nextTick=null,this.listeners=[],this.options=t,this.beforeHooks=[],this.resolveHooks=[],this.afterHooks=[],this.matcher=jt(t.routes||[],this),this.init(),this.history.listen(t=>{this.listeners.forEach(e=>e(t))})}listen(t){return this.listeners.push(t),()=>{this.listeners.splice(this.listeners.indexOf(t),1)}}match(t,e,n){return this.matcher.match(t,e,n)}get currentRoute(){return this.history&&this.history.current}beforeEach(t){return ae(this.beforeHooks,t)}beforeResolve(t){return ae(this.resolveHooks,t)}afterEach(t){return ae(this.afterHooks,t)}onReady(t,e){this.history.onReady(t,e)}onError(t){this.history.onError(t)}push(t,e,n){this.history.push(t,e,n)}replace(t,e,n){this.history.replace(t,e,n)}go(t){this.history.go(t)}back(){this.go(-1)}forward(){this.go(1)}getMatchedComponents(t){const e=t?t.matched?t:this.resolve(t).route:this.currentRoute;return e?[].concat.apply([],e.matched.map(t=>Object.keys(t.components).map(e=>t.components[e]))):[]}resolve(t,e,n){const r=Tt(t,e=e||this.history.current,n,this),o=this.match(r,e),s=o.redirectedFrom||o.fullPath;return{location:r,route:o,href:function(t,e,n){var r="hash"===n?"#"+e:e;return t?it(t+"/"+r):r}(this.history.base,s,this.mode),normalizedTo:r,resolved:o}}addRoutes(t){this.matcher.addRoutes(t),this.history.current!==et&&this.history.transitionTo(this.history.getCurrentLocation())}}function ae(t,e){return t.push(e),()=>{const n=t.indexOf(e);n>-1&&t.splice(n,1)}}ie.version="0.1.0";class ce extends ie{init(){this.mode="history",this.history=new Gt(this,this.options.base),this.history.transitionTo(this.history.getCurrentLocation())}}class ue extends ie{init(){this.mode="hash";const t=this.history=new Zt(this,this.options.base,!!this.options.fallback),e=()=>{t.setupListeners()};t.transitionTo(t.getCurrentLocation(),e,e)}}class he extends ie{init(){this.mode="abstract",this.history=new se(this,this.options.base)}}export{M as RouterProvider,B as RouterView,J as RouterLink,ce as HistoryRouter,ue as HashRouter,he as AbstractRouter,R as router,O as getRouter,T as setRouter,j as route,C as getRoute,A as setRoute,S as matched,P as getMatched,L as setMatched};